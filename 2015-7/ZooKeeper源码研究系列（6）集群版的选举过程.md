#1 系列目录

-	[ZooKeeper源码研究系列（1）源码环境搭建](http://my.oschina.net/pingpangkuangmo/blog/484955)
-	[ZooKeeper源码研究系列（2）客户端创建连接过程分析](http://my.oschina.net/pingpangkuangmo/blog/486780)
-	[ZooKeeper源码研究系列（3）单机版服务器介绍](http://my.oschina.net/pingpangkuangmo/blog/491673)
-	[ZooKeeper源码研究系列（4）集群版服务器介绍](http://my.oschina.net/pingpangkuangmo/blog/495311)
-	[ZooKeeper源码研究系列（5）集群版建立连接过程](http://my.oschina.net/pingpangkuangmo/blog/496136)

#2 分布式一致性问题

##2.1 Leader选举

什么是Leader选举？

表面上来看就是：一堆服务器通过约定的算法投票达成共识（即实现一致性），选举出一个Leader出来。其中包含了两个问题：

-	点对点通信问题：即因通信问题可能出现自己发送的投票丢失或者没有接收到别人的投票的情况。

-	如何根据投票选举的问题：当接收到投票之后（每个服务器接收的投票数量因上述通信问题可能不一样），如何让大家选出的投票一致呢（期间可能涉对比投票、变更投票、再次投票以致多轮投票过程）？

这些问题就是在分布式的系统中，面临复杂的网络环境，实现一致性决议的问题。还有类似经典分布式一致性问题，如两将军问题、拜占庭将军问题。
#2.2 两将军问题

可以参考耗子叔的文章[分布式系统的事务处理](http://coolshell.cn/articles/10910.html)

这篇文章中就有两将军问题说明。同样维基百科中这样描述[拜占庭将军问题](https://zh.wikipedia.org/wiki/%E6%8B%9C%E5%8D%A0%E5%BA%AD%E5%B0%86%E5%86%9B%E9%97%AE%E9%A2%98)

>军队与军队之间分隔很远，传讯息的信差可能在途中路上阵亡，或因军队距离，不能在得到消息后即时回复，发送方也无法确认消息确实丢失的情形，导致不可能达到一致性。在分布式计算上，试图在异步系统和不可靠的通道上达到一致性是不可能的。因此对一致性的研究一般假设信道是可靠的，或不存在异步系统上而行。

两将军问题主要强调：两个服务器在不可靠的信道上实现一个确定的决议是很难的，只能是尽量降低信道的不可靠性来实现一致性决议。Leader选举的服务器基本是内网服务器，信道的可靠性还是很大的。

#2.3 拜占庭将军问题

上述两将军问题仅仅是两个，拜占庭将军问题就更复杂了，即在多个将军其中还有内奸的情况下，如何达成一个好的决议。维基百科中这样描述[两军问题](https://zh.wikipedia.org/wiki/%E6%8B%9C%E5%8D%A0%E5%BA%AD%E5%B0%86%E5%86%9B%E9%97%AE%E9%A2%98)

>拜占庭位于现在土耳其的伊斯坦布尔，是东罗马帝国的首都。由于当时拜占庭罗马帝国国土辽阔，为了防御目的，因此每个军队都分隔很远，将军与将军之间只能靠信差传消息。

>在战争的时候，拜占庭军队内所有将军和副官必需达成一致的共识，决定是否有赢的机会才去攻打敌人的阵营。但是，军队可能有叛徒和敌军间谍，左右将军们的决定，扰乱军队整体的秩序。在进行共识时，结果并不代表大多数人的意见。这时候，在已知有成员谋反的情况下，其余忠诚的将军在不受叛徒的影响下如何达成一致的协议，拜占庭问题就此形成。

拜占庭将军问题是在可靠信道的前提下：给出了这样的一个结论

#4 Paxos协议

#5 Zab协议
