# 1 目录

# 2 HDFS的权限管理介绍

HDFS的权限管理分成2大部分：

-	类似linux的基本权限管理（粗粒度）

	针对管理对象分三种：user、group、other方式的权限管理方式

	-	user:即目录或文件的owner
	-	group:即上述owner所在的组
	-	other：其他用户的统称

-	ACL方式的权限管理（细粒度）

	可以精确控制到某个user、某个group具有对应的权限

2种方式具体见下图

![基本权限方式和ACL权限方式](https://static.oschina.net/uploads/img/201606/21224904_KZpt.png "基本权限方式和ACL权限方式")

基本的权限方式如同linux中目录或文件的权限管理方式，它是一种粗粒度的，不能控制到某一个用户如t1。ACL的权限管理方式就可以，如下

user:t1:r-x

表示用户t1具有读和可执行的权限（在HDFS中没有可执行的概念，暂且这么叫吧，这里的x权限就是进入目录和列出目录下的文件或内容的权限）

# 3 HDFS基本权限管理

创建一个文件或目录，初始的基本权限是多少呢？经历如下2过程：

## 3.1 默认的文件或目录权限

创建文件或目录的时候可以指定权限，没有指定的话，就使用默认的权限，如下

目录：777

文件：666

## 3.2 应用客户端配置的uMask

注意：这个配置是客户端可以配置的，即客户端自己主宰创建文件或目录的权限。

umask的作用：

就是对HDFS基本权限的限制，如022分别表示：0表示对owner没有限制，2表示对group不允许有写权限，2表示对other不允许有写权限。

应用客户端配置的umask其实就是拿用户设置的权限减去上述umask权限，就得到文件或目录的最终权限了。如创建目录，默认777权限，然后减去umask权限022就等于755，即默认情况下owner拥有读写和可执行权限，owner所在group拥有读和可执行权限，other拥有读和可执行的权限

下面重点来说下umask的获取过程：

-	首先尝试获取配置文件中的fs.permissions.umask-mode属性，如022，然后构建出umask权限对象

-	如果上述属性没有配置的话，获取dfs.umask属性（过时了，推荐用第一种方式），这种方式的umask是10进制形式，如上述的022=2x16+2=18即这里的umask要配置成18

-	如果上述属性也没有配置的话，默认使用18即022来构建出umask对象

至此，在没有ACL设置的情况下创建文件或目录的权限即上述过程了。

## 3.3 Sticky Bit



# 4 HDFS ACL权限管理